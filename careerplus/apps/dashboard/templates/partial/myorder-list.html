{% if order_list %}
<ul class="table-data panel-group mt-0" id="accordion" role="tablist" aria-multiselectable="true">
<li class="data-heading">
  <datalist class="col-sm-3">
    Order ID
  </datalist>
  <datalist class="col-sm-2">
    Placed on
  </datalist>
  <datalist class="col-sm-1">
    Status
  </datalist>
  <datalist class="col-sm-2">
    No of items
  </datalist>
  <datalist class="col-sm-3 col-md-2">
    Total amount
  </datalist>
  <datalist class="col-sm-1">
  </datalist>
</li>

{% for data in order_list %}
    {% with order=data.order orderitems=data.orderitems item_count=data.item_count %}
        <li>
          <div class="panel-titles" role="tab" id="heading{{order.id}}">
            <div class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse{{order.id}}" aria-expanded="false" aria-controls="collapse{{order.id}}">
              <datalist class="col-sm-3">
                <strong>{{order.number}}</strong>
              </datalist>
              <datalist class="col-sm-2">
                {{order.date_placed.date}}
              </datalist>
              <datalist class="col-sm-1">
                {% if order.status == 1 %}
                    Open
                {% elif order.status == 0 %}
                    Unpaid
                {% elif order.status == 3 %}
                    Closed
                {% endif %}

              </datalist>
              <datalist class="col-sm-2">
                <strong>{{item_count}} {% if item_count > 1 %}items{% else %}item{% endif %}</strong>
              </datalist>
              <datalist class="col-sm-2">
                <strong>{{order.get_currency}} {{order.total_incl_tax}}/-</strong>
              </datalist>
              <datalist class="col-sm-2">
                {% if order.status == 1 or order.status == 3 %}
                    <form role="form" id="download-invoice-form{{order.pk}}" method="POST" action="{% url "dashboard:dashboard-invoicedownload" %}">
                      <div style="display:none">
                          <input type="hidden" name="csrfmiddlewaretoken" 
                          value="{{csrf_token}}" />
                          <input type="hidden" name="order_pk" value="{{order.pk}}" />
                     </div>
                      <strong><a role="button" onclick="downloadOrderInvoice('{{order.pk}}')" id="download-order-invoice{{order.pk}}">Download invoice</a></strong>
                    </form>
                {% endif %}
              </datalist>
            </div>
          </div>          
          <ul id="collapse{{order.id}}" class="panel-collapse collapse {% if forloop.counter == 1 %}in{% endif %}" role="tabpanel" aria-labelledby="heading{{order.id}}">
            <li class="data-heading">
              <datalist class="col-sm-6">
                Item
              </datalist>
              <datalist class="col-sm-3">
                Item status
              </datalist>
            </li>
            {% for obj in orderitems %}
                <li>
                  <datalist class="col-sm-6">
                    {% if obj.product.type_flow == 12 and obj.parent %}
                        <strong><a>{{obj.parent.product.name}}: {{obj.product.name}}</a></strong>
                    {% else %}
                        <strong>
                          <a>
                            {{obj.product.name}}
                            {% if obj.product.get_exp %}
                             - {{obj.product.get_exp}}
                            {% endif %}
                            {% if obj.product.get_studymode %}
                             - {{obj.product.get_studymode}}
                            {% endif %}
                            {% if obj.product.get_coursetype %}
                             - {{obj.product.get_coursetype}}
                            {% endif %}
                            {% if obj.product.get_duration %}
                             - {{obj.product.get_duration}}
                            {% endif %}
                          </a>
                      </strong>
                    {% endif %}
                  </datalist>
                  <datalist class="col-sm-3">
                    {% if obj.oi_status == 4 %}
                        Closed
                    {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                      {{obj.get_user_oi_status}}
                    {% elif order.status == 0 %}
                        Unpaid
                    {% elif order.status == 0 %}
                        Unpaid
                    {% elif order.status == 1 %}
                        Service in progress
                    {% endif %}
                  </datalist>
                </li>
            {% endfor %}
          </ul>
        </li>
    {% endwith %}
{% endfor %}

</ul>
{% endif %}
