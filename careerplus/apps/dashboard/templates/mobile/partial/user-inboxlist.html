{% load static filter-tags %}

{% for obj in orderitems %}
    <div class="box row mb-30">
        {% comment %} {% if obj.product.get_duration_in_day %}
               <div class="days-left">{{obj.product.get_duration_in_day}} days left</div>
        {% endif %} {% endcomment %}
        <p class="fs-16 pb-5"><a href="{% url "dashboard:dashboard-itemdetail" %}?oi={{obj.pk}}">{{obj.product.get_name}}
            {% if obj.product.get_exp_db %}
             - {{obj.product.get_exp_db}}
            {% endif %}
            {% if obj.product.get_studymode_db %}
             - {{obj.product.get_studymode_db}}
            {% endif %}
            {% if obj.product.get_coursetype_db %}
             - {{obj.product.get_coursetype_db}}
            {% endif %}
            {% if obj.product.get_duration_db %}
             - {{obj.product.get_duration_db}}
            {% endif %}
        </a></p>
        <p class="fs-12 c9">Order ID : {{obj.order.number}}</p>

        <div class="light-blue">
            {% if obj.product.type_flow == 17 %}
                <form role="form" id="download-resume-form{{obj.order.pk}}" method="POST" action="{% url "dashboard:dashboard-resumetemplatedownload" %}" >
                    <div style="display:none">
                        <input type="hidden" name="csrfmiddlewaretoken" value="{{csrf_token_value}}" />
                        <input type="hidden" name="order_pk" value="{{obj.order.pk}}" />
                        <input type="hidden" name="product_id" value="{{obj.product_id}}"/>
                    </div>
                   <p>
                        <a role="button" onclick="downloadOrderTemplate('{{obj.order.pk}}');event.stopPropagation()" id="download-order-invoice{{obj.order.pk}}">Download</a>
                        <a class="edit-template" role="button" onclick="editTemplate();event.stopPropagation()";>Edit Template</a>
                   </p>
                </form>

            {% elif obj.product.type_flow == 1 or obj.product.type_flow == 12 or obj.product.type_flow == 13 %}
                {% if obj.oi_status == 2 %}
                    <p><strong>Status</strong>: {{obj.get_user_oi_status}}
                    </p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% elif obj.oi_status == 23 and obj.draft_counter %}
                    <p><strong>Status</strong>: Modifications requested
                    </p>
                {% elif obj.oi_status == 25 and obj.draft_counter %}
                    <p><strong>Status:</strong> Modifications requested</p>
                {% elif obj.oi_status == 26 and obj.draft_counter %}
                    <p><strong>Status:</strong> Modifications requested</p>
                {% elif obj.oi_status == 24 and obj.draft_counter == 1 %}
                    <p><strong>Status:</strong> Document is ready - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                {% elif obj.oi_status == 24 and obj.draft_counter < max_draft_limit %}
                    <p><strong>Status:</strong> Revised Document is ready - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                {% elif obj.oi_status == 4 and obj.draft_counter == max_draft_limit %}
                    <p><strong>Status:</strong> Final Document is ready - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 4 and obj.draft_counter < max_draft_limit %}
                    <p><strong>Status:</strong> Service has been processed and Document is finalized - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                {% elif obj.order.auto_upload %}
                    <p><strong>Status:</strong> Service is under progress</p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% else %}
                    <p><strong>Status:</strong> Service is under progress</p>
                {% endif %}

            <!-- flow 8 -->
            {% elif obj.product.type_flow == 8 %}
                {% if obj.oi_status == 2 %}
                    <p><strong>Status</strong>: {{obj.get_user_oi_status}}
                    </p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% elif obj.oi_status == 45 and obj.draft_counter %}
                    <p><strong>Status:</strong> Modifications requested</p>

                {% elif obj.oi_status == 47 and obj.draft_counter %}
                    <p><strong>Status:</strong> Modifications requested</p>

                {% elif obj.oi_status == 48 and obj.draft_counter %}
                    <p><strong>Status:</strong> Modifications requested</p>
                {% elif obj.oi_status == 46 and obj.draft_counter == 1 %}
                    <p><strong>Status:</strong> Document is ready - <a href="{% url "dashboard-draf-download" obj.pk %}" download>Download</a></p>

                {% elif obj.oi_status == 46 and obj.draft_counter < max_draft_limit %}
                    <p><strong>Status:</strong> Revised Document is ready - <a href="{% url "dashboard-draf-download" obj.pk %}" download>Download</a></p>
                {% elif obj.oi_status == 4 and obj.draft_counter == max_draft_limit %}
                    <p><strong>Status:</strong> Final Document is ready - <a href="{% url "dashboard-draf-download" obj.pk %}" download>Download</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 4 and obj.draft_counter < max_draft_limit %}
                    <p><strong>Status:</strong> Service has been processed and Document is finalized - <a href="{% url "dashboard-draf-download" obj.pk %}" download>Download</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                {% elif obj.order.auto_upload %}
                    <p><strong>Status:</strong> Service is under progress</p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% else %}
                    <p><strong>Status:</strong> Service is under progress</p>
                {% endif %}

            {% elif obj.product.type_flow == 3 %}
                {% if obj.oi_status == 2 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="javascript:void(0)" class="sidebar-secondary-trigger">Upload Resume</a></p>
                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> Service has been processed and Final document is ready - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                {% elif obj.order.auto_upload %}
                    <p><strong>Status:</strong> Service is under progress</p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% else %}
                    <p><strong>Status:</strong> Service is under progress</p>
                {% endif %}

            {% elif obj.product.type_flow == 2 or obj.product.type_flow == 14 %}
                {% if obj.oi_status == 5 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}
                     {% if  obj.product.type_flow == 2 and obj.product.vendor.slug == 'neo'  and not obj.neo_mail_sent%}
                        <span id="board_neo_btn"><a role="button" onclick="boardNeoUser('{{obj.pk}}',)">:- Board On Neo</a></span>
                    {% endif %}
                     {% if  obj.product.type_flow == 2 and obj.product.vendor.slug == 'neo'  and obj.neo_mail_sent%}
                        <span id="board_neo_msg"> :- Please Confirm Boarding on Mail Sent to you</span>
                    {% endif %}
                    </p>
                    
                {% elif obj.oi_status == 6 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> Service has been processed - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>
                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                {% endif %}

            {% elif obj.product.type_flow == 4 %}
                {% if obj.oi_status == 2 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="javascript:void(0)" class="sidebar-secondary-trigger">Upload Resume</a></p>

                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> Service has been processed - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download Credential</a></p>
                    {% if not obj.order.service_resume_upload_shine %}
                        <div><input type="checkbox" onclick="uploadResumeShine(this,{{obj.pk}})">Upload Resume to Shine</button></div>
                    {% endif %} 
                {% elif obj.oi_status == 61 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                {% elif obj.order.auto_upload %}
                    <p><strong>Status:</strong> Service is under progress</p>
                    <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger" id="upload_resume">Upload Resume</a>
                {% else %}
                   <p><strong>Status:</strong> Service is under progress</p>

                {% endif %}
            {% elif obj.product.type_flow == 5 %}
                {% if obj.oi_status == 2 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="javascript:void(0)" role="button" class="sidebar-secondary-trigger">Upload Resume</a></p>

                {% elif obj.oi_status == 4 or obj.oi_status == 28 or obj.oi_status == 29 %}
                    <p><strong>Status:</strong> Service has been processed</p>

                {% elif obj.oi_status == 61 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% else %}
                   <p><strong>Status:</strong> Service is under progress</p>

                {% endif %}

            {% elif obj.product.type_flow == 6 %}
                {% if obj.oi_status == 81 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>

                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> Service has been processed - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>

                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% else %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} </p>

                {% endif %}

            {% elif obj.product.type_flow == 7 or obj.product.type_flow == 15 %}
                {% if obj.oi_status == 2 %}
                   <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="javascript:void(0)" class="sidebar-secondary-trigger">Upload Resume</a></p>
                   <div class="booster-msg">* Uploaded resume will be boosted</div>
                {% else %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} {% if obj.oi_draft.name %} <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={%if obj.oi_draft.name %}{{ obj.oi_draft.name }} {% else %} {{ obj.oi_resume.name }} {%  endif %}"> - Download</a> {% endif %}</p>
                {% endif %}

            {% elif obj.product.type_flow == 9 %}
                {% with obj.get_roundone_status as op_status %}
                    {% if op_status == 141 %}
                        <p><strong>Status:</strong> Your profile to be shared with interviewer is pending - <a href="#">Complete Profile</a></p>
                    
                    {% elif op_status == 142 %}
                        <p><strong>Status:</strong> Service is under progress - <a href="#">Edit your profile</a></p>

                    {% elif op_status == 143 %}
                        <p><strong>Status:</strong> Service has been expired</p>

                    {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                        <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                    {% endif %}
                {% endwith %}

            {% elif obj.product.type_flow == 10 %}
                {% if obj.oi_status == 5 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>
                
                {% elif obj.oi_status == 101 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a href="#">Take Test</a></p>

                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> Service has been processed - <a href="{% url "dashboard:dashboard-resumedownload" obj.order.pk %}?path={{obj.oi_draft.name}}" download>Download</a></p>

                {% elif obj.oi_status == 161 or obj.oi_status == 162 or obj.oi_status == 163 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% endif %}

            {% elif obj.product.type_flow == 16 and obj.product.sub_type_flow == 1602 %}
                 {% if obj.oi_status == 5 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}} - <a target="_blank" href="{{obj.autologin_url}}">Take Test</a></p>
                    
                {% elif obj.oi_status == 4 %}
                    <p><strong>Status:</strong> {{obj.get_user_oi_status}}</p>

                {% endif %}
            {% endif %}

            {% if obj.oi_status == 28 or obj.oi_status == 34 or obj.oi_status == 35 %}
                {% if obj.days_left_oi_product > 0 and obj.product.is_pause_service  %}
                    {% if obj.service_pause_status %}
                        <div class="light-blue__pause" onclick="pause_resume_service_mobile(this,{{obj.id}},34)">
                            <span class="light-blue__pause--button"></span>
                            <p class="pb-0">Pause Service</p>
                        </div><!-- // Pause Service -->
                    {% else %}
                        <div class="light-blue__pause" onclick="pause_resume_service_mobile(this,{{obj.id}},35)">
                            <span class="light-blue__pause--playBtn">
                                <span class="right-arrow"></span>
                            </span>
                            <p class="pb-0">Resume Service</p>
                        </div><!-- // Resume Service -->
                    {% endif %}
                {% endif %}
            {% endif %}
        </div><!-- /.blue box -->

        {% if obj.product.type_flow == 5 %}
            {% if obj.oi_status == 28 or obj.oi_status == 34 or obj.oi_status == 35 %}
                {% if obj.days_left_oi_product > 0  %}
                 <div class="day-remains">
                    <span class="day-remains--head">Day Remaining</span>
                    <ul class="day-remains--counts">
                        {% if obj.days_left_oi_product|modulo:2 > 0 %}
                        <li>{{ obj.days_left_oi_product|modulo:2 }}</li>
                        {% endif %}
                        <li>{{ obj.days_left_oi_product|modulo:1 }}</li>
                        <li>{{ obj.days_left_oi_product|modulo:0 }}</li>
                    </ul>
                </div><!-- // Day Remaining-->
                {% endif %}
            {% endif %} 
            
        {% endif %}
       


        {% if obj.oi_status == 24 or obj.oi_status == 46 %}
            <div class="button-wrap mt-15">
                <span class="accept"><a role="button" onClick="openPopup('accept-modal{{obj.pk}}');"><sup class="icon-tick-green"></sup>Accept</a></span>
                <span class="reject"><a href="{% url "dashboard:dashboard-reject" %}?oi={{obj.pk}}"><sup class="icon-tick-cross"></sup>Reject</a></span>
                <div class="clearfix"></div> 

                <!-- The Accept Modal -->
                <div id="accept-modal{{obj.pk}}" class="modal">
                  <div class="modal-helper">
                    <div class="modal-vertical-center">
                       <!-- Modal content -->
                        <div class="modal-content">
                          <div class="header">
                            <h2>Accept Confirmation</h2>
                            <a role="button" class="icon-close" onclick="closePopup();"></a>
                          </div><!-- end of header -->

                          <div class="content-box pt-0 pb-0">
                            <p><strong>Are you sure you want to accept?</strong></p>
                            <p class="c9 fs-12">Note: Once you accept, your service will be closed.</p>
                            <div class="text-center mt-10">
                                <form role="form" id="mobileaccept-form{{obj.pk}}">
                                    <div style='display:none'>
                                       <input type='hidden' name='csrfmiddlewaretoken' value='{{ csrf_token_value }}'/>
                                       <input type='hidden' name='oi_pk' value='{{obj.pk}}'/>
                                    </div>
                                    <p><button class="btn w100 btn-round btn-blue" onClick="mobileAccept('{{obj.pk}}')">Accept</button></p>
                                    <p class="fs-12"><a role="button" onclick="closePopup();">Skip</a></p>
                                </form>
                            </div>
                          </div><!-- Tab content ends here -->
                        </div><!-- end of modal content here -->
                    </div><!-- end of modal-vertical-center -->
                  </div><!-- end of modal-helper -->
                </div><!-- end of Login modal here --> 
            </div><!-- /.button-wrap -->
        {% endif %}
        {% if obj.oi_status == 4 and not obj.user_feedback %}
            <a href="{% url "dashboard:dashboard-itemfeedback" %}?oi={{obj.pk}}">
                <div class="grey-box text-center mt-15">
                    <div class="row">
                        <div class="rating inline-block ml-0 fs-14">
                            <strong>Your feedback </strong>
                            <sup class="fill-star"></sup>
                            <sup class="fill-star"></sup>
                            <sup class="fill-star"></sup>
                            <sup class="fill-star"></sup>
                            <sup class="fill-star"></sup>
                            
                        </div><!-- end of star rating -->
                        <p class="pb-0 fs-13 c6">Write feedback and earn loyalty points</p>
                    </div>
                </div><!-- /.grey-box -->
            </a>
        {% endif %}
    </div><!-- /.box and row -->
{% endfor %}


{% if orderitems.has_next %}
    <div id="load_more_item">
        <form role="form" id="load-orderitem-form">
            <div style='display:none'>
                <input type='hidden' name='csrfmiddlewaretoken' value='{{ csrf_token_value }}'/>
                <input type="hidden" name="page" value="{{orderitems.next_page_number}}">
                <input type="hidden" name="last_month_from" value="{{last_month_from}}">
                <input type="hidden" name="select_type" value="{{select_type}}">
            </div>
        </form>
        <div class="w100 text-center">
            <a class="btn-slg btn-grey block" role="button" id="load-more-orderitem" href="javascript:void();" ></span>Load more</a>
        </div>
        <!--a role="button" id="load-more-orderitem" class="load-more-list col-sm-12">Load more</a-->
    </div>
{% endif %}