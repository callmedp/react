{% load static %}
{% load static compress %}
<!-- content start -->
{% block css_section %}
    {% compress css %}
    <link type="text/css" href="{% static 'shinelearn/css/common/popup1.css' %}" rel="stylesheet">
    <link type="text/css" href="{% static 'shinelearn/css/talenteconomy/prism.css' %}" rel="stylesheet">
    {% endcompress %}
{% endblock css_section %}

{% for main_article in page_obj %}
<div class="article-detail-content" itemscope itemtype="https://schema.org/Article">

    <style>
    .close_popup_modal{{main_article.id}}{color:#aaa;float:right;font-size:28px;margin-top:-15px;font-weight:700}.close_popup_modal{{main_article.id}}:hover,.close_popup_modal{{main_article.id}}:focus{color:#000;text-decoration:none;cursor:pointer}
    </style>

    <!-- page heading -->
    <div class="page-header">
        <h1 itemprop="name">{{main_article.heading}}</h1>
        <div class="editor-comments-views">
                 {% if main_article.author %}
            <span>

                {% if main_article.author.image %}
              <img loading="lazy" aria-label="{{main_article.author.image_alt}}" src="{{main_article.author.image.url}}" class="author-small-pic" alt="{{main_article.author.image_alt}}">
                {% endif %}

              <a href="/talenteconomy/authors/{{main_article.author.slug}}" title="{{main_article.author.name}}">{{main_article.author.name}}</a> / <span itemprop="datePublished">{{main_article.last_modified_on.date}}</span>
            </span>
            <meta itemprop="author" content={{main_article.author.name}}>
             {% endif %}
            {% if main_article.comment_moderated > 0 %}
            <span>
                <figure class="comment-small-icon"></figure> 
                <strong>{{main_article.comment_moderated}}</strong> comments
            </span>
            {% endif %}

            <span>
            {% if main_article.no_views > 0 %}
              <figure class="view-icon"></figure> 
              <strong>{{main_article.no_views}}</strong>
            </span>
            {% endif %}
        </div>
        <div class="social-login">
          <span>Share</span>
            <a class="facebook" id="article_share" href="https://www.facebook.com/sharer/sharer.php?u={{SITEDOMAIN}}{{main_article.get_absolute_url}}" article-slug="{{main_article.slug}}" target="_blank"></a>
            
            <a class="twitter" id="article_share" article-slug="{{article.slug}}" href="https://twitter.com/intent/tweet?text={{main_article.title}}&url={{SITEDOMAIN}}{{main_article.get_absolute_url}}" target="_blank"></a>

            <a class="linkedin" id="article_share" target="_blank" article-slug="{{article.slug}}" href="https://www.linkedin.com/shareArticle?mini=true&url=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}&title={{main_article.title}}&summary={{main_article.meta_desc}}&source={{SITEDOMAIN}}/"></a>

            <a class="printrest" id="article_share" target="_blank" article-slug="{{article.slug}}" href="http://pinterest.com/pin/create/link/?url=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}&media={{STATIC_URL}}{{main_article.image}}&description={{main_article.meta_desc}}"></a>
            
            <a class="whatsapp" id="article_share" target="_blank" article-slug="{{article.slug}}" href="https://web.whatsapp.com/send?l=en&text=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}"></a>

        </div>
    </div>


    <figure>
        <img loading="lazy" aria-label="{{main_article.image_alt}}" src="{% if main_article.image %}{{main_article.image.url}} {% endif %}" alt="{{main_article.image_alt}}" class="img-responsive" itemprop="image">
    </figure>

    <article class="article-content" itemprop="articleBody">
        {% if request.amp %}<pre>{{main_article.content|striptags|safe}}</pre>{%else%}{{main_article.content|safe}}{%endif%}
    </article>

    <div class="clearfix"></div>

    <div class="social-login">
      <a class="facebook" id="article_share" href="https://www.facebook.com/sharer/sharer.php?u={{SITEDOMAIN}}{{main_article.get_absolute_url}}" article-slug="{{main_article.slug}}" target="_blank"></a>
            
      <a class="twitter" id="article_share" article-slug="{{article.slug}}" href="https://twitter.com/intent/tweet?text={{main_article.title}}&url={{SITEDOMAIN}}{{main_article.get_absolute_url}}" target="_blank"></a>

      <a class="linkedin" id="article_share" target="_blank" article-slug="{{article.slug}}" href="https://www.linkedin.com/shareArticle?mini=true&url=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}&title={{main_article.title}}&summary={{main_article.meta_desc}}&source={{SITEDOMAIN}}/"></a>

      <a class="printrest" id="article_share" target="_blank" article-slug="{{article.slug}}" href="http://pinterest.com/pin/create/link/?url=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}&media={{STATIC_URL}}{{main_article.image}}&description={{main_article.meta_desc}}"></a>
      
      <a class="whatsapp" id="article_share" target="_blank" article-slug="{{article.slug}}" href="https://web.whatsapp.com/send?l=en&text=https://{{SITEDOMAIN}}{{main_article.get_absolute_url}}"></a>
    </div>

    <meta itemprop="headline" content="{{main_article.heading}}">
    <meta itemprop="dateModified" content="{{main_article.last_modified_on.date}}">
    <meta itemprop="mainEntityOfPage" content="{% url 'talent:talent-landing' %}">
    
  <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization" >
    <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
      <meta itemprop="url" content="{% static 'shinelearn/images/logo.png' %}">
    </div>
    <meta itemprop="name" content="Shine">
  </div>

    <!-- Tagged in box -->
    {% with main_article.tags.all as tags %}
    {% if tags %}
    <div class="tagged-in mt-40">
        <strong>Tagged in</strong>
        {% for tag in tags %}
        <span><a href="{% url "talent:te-articles-by-tag" tag.slug %}" title="{{tag.name}}">{{tag.name}}</a></span>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Related Articles -->
    {% if related_articles %}
      <div class="related-article article-list">
        <h2><strong>Related Articles:</strong></h2>
        <div class="row mt-20">
        {% for article in related_articles %}
          <div class="col-md-4">
            <div class="box-panel">
              <a href="{{article.get_absolute_url}}">
                <figure class="pr mb-0">
                  <img aria-label="{{article.image_alt}}" src="{{article.image.url}}" alt="{{article.image_alt}}" itemprop="image">
                </figure>

                <h3 class="heading-article" itemprop="name">{{article.heading}}</h3>
              </a>

              <span class="view-forward">
                <figure class="forward-icon mb-0"></figure> {{article.no_shares}}
                <figure class="view-icon ml-20 mb-0"></figure> {{article.no_views}}
              </span>
            </div>
          </div>
        {% endfor %}
          <!-- // col -->
        </div>
      </div><!-- //Related Articles -->
    {% endif %}

    <div class="modal fade bs-example-modal-sm" id="popup_subscribe{{main_article.id}}">
      <div class="modal-dialog modal-sm modal-custom" role="document">
      <div class="modal-content" style="padding: 20px;">
            <span class="close_popup_modal{{main_article.id}}">&times;</span>
            <h2 class="heading-right">Looks interesting?</h2>
            <p>Subscribe & Get our daily newsletter. Fill the details below.</p>
            <form class="te-form mt-20" role="form"  id="enquireform{{main_article.id}}" name="enq{{main_article.id}}" >
                <div style='display:none'>
                    <input type='hidden' name='csrfmiddlewaretoken' value='{{ csrf_token }}'/>
                </div>

                <div class="form-group">
                    <input type="text" class="input_field form-control" name="name"  id="id_name{{main_article.id}}"
                           placeholder="Name"
                           maxlength="100" value="{{request.session.full_name}}">
                    <!-- <label class="input_label" for="id_name">Name<sup>*</sup></label> -->
                </div>

                <div class="form-group">
                    <input type="email" class="input_field form-control" name="email"  id="id_email{{main_article.id}}"  placeholder="Email"
                           maxlength="100" value="{{request.session.email}}">
                    <!-- <label class="input_label" for="id_email">Email<sup>*</sup></label> -->
                </div>

                <div class="form-group" style="display: flex;">
                    <div class="country-code">
                        <div class="custom-select">
                            <select class="form-control" id="id_country_name{{main_article.id}}" name="country">
                                {% for country in country_choices %}
                                <option value="{{country.0}}" {% if country.0 == initial_country %} selected {% endif %} >{{country.0}}&nbsp;&nbsp;&nbsp;&nbsp; -- &nbsp;&nbsp;&nbsp;&nbsp;{{country.1}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div style="position: relative;">
                        <input type="text" class="input_field form-control" name="number"
                               id="id_cell_phone{{main_article.id}}"
                               placeholder="Mobile" maxlength="15" value="{{request.session.mobile_no}}">
                        <!-- <label class="input_label" for="id_cell_phone">Mobile</label> -->
                        <span class="error-txt position-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <textarea class="form-control" rows="1" name="msg" id="msg{{main_article.id}}" placeholder="Message"
                              maxlength="500"></textarea>
                    <span class="error-txt"></span>
                </div>


                <input type="hidden" name="product" value="{{main_article.pk}}">
                <input type="hidden" name="prd" value="{{main_article.heading}}">
                <input type="hidden" name="path" value="{{main_article.get_absolute_url}}">
                <!-- <input type="hidden" name="email" class="form-control" value="{{request.session.email}}"> -->
                <input type="hidden" name="lsource" value="8">
                <input type="hidden" name="campaign" value="blogsonline">
                <button type="button" id="enquire_form{{main_article.id}}" class="submit-button">Subscribe Now</button>
            </form>
        </div>
      </div>
    </div>

    <!-- comments box -->
    {% if main_article.allow_comment %}
    <div class="comments-box mb-40 mt-40">
        <!-- comments box heading-->
        <div class="comments-box-heading is-clickable">
            <span class="comments-icon mr-10"></span> <strong><label for="total_comment{{main_article.id}}" class="is-clickable">{% if main_article.comment_moderated > 0 %}{{main_article.comment_moderated}} comments{% else %}No Comments {% endif %}</label></strong>
            {% if not main_article.comment_moderated %}
              <p>Currently there are no comments on this article</p>
            {% endif %}
            <!-- <a role="button" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">Leave a comment</a> -->
            <!-- <input type="radio" class="hide" onchange="openCommentBox('{{main_article.id}}', 2)" id="total_comment{{main_article.id}}"> -->
        </div>
        <div id="comment-box{{main_article.id}}" class="mt-20">
            
        </div>

    </div>
    {% endif %}

</div>
<script>
        openCommentBox('{{main_article.id}}', 2)
        var span = document.getElementsByClassName("close_popup_modal{{main_article.id}}")[0];
        span.onclick = function() {
        $('#popup_subscribe{{main_article.id}}').modal('toggle');
        }
        $(document).ready(function() {
          setTimeout(function() {
              $("#popup_subscribe{{main_article.id}}").modal('show');
          }, 15000);
        });

    $.validator.addMethod("numbercheck", function (value, element) {
        if( $('#id_country_code{{main_article.id}}').val() == "91" && $('#id_cell_phone{{main_article.id}}').val().length != 10){
             $('#enquire_form{{main_article.id}}').removeAttr("disabled");
            return false;
        }
        else if($('#id_cell_phone{{main_article.id}}').val().length >= 8 && $('#id_cell_phone{{main_article.id}}').val().length <= 15){
            return true
        }
    }, 'Please enter valid mobile number');

    $(function() {
      // Initialize form validation on the registration form.
      // It has the name attribute "registration"
      $("form[name='enq{{main_article.id}}']").validate({
        // Specify validation rules
        rules: {
            number: {
                numbercheck : true,
            },
            msg: {
                maxlength:250,
            }
        },
        // Specify validation error messages
        messages: {
            number: {
                    required: "Please enter your number",
                    minlength: "Please enter atleast 8 digit number",
            },

            msg: {
                maxlength: "Message should be within 250 characters",
            },
        },
        // Make sure the form is submitted to the destination defined
        // in the "action" attribute of the form when valid
      });
    });
    $('#enquire_form{{main_article.id}}').click(function(event) {
    event.preventDefault();
    $('#enquire_form{{main_article.id}}').attr("disabled", true);
    var $enquireform{{main_article.id}} = $("#enquireform{{main_article.id}}");
    var typeOfProduct = 'Talent Enquiry';
    flag = true;
    if($('#id_cell_phone{{main_article.id}}').val().length != 10){
             $('#enquire_form{{main_article.id}}').removeAttr("disabled");
             flag = false;
            pop('Please enter valid number');
        }
    if (flag) {
        var formData = $enquireform{{main_article.id}}.serialize();
        $.ajax({
            url: "/lead/lead-management/",
            type: "POST",
            data: formData,
            success: function(data, textStatus, jqXHR) {
                gaEventFunc(typeOfProduct,'success');
                pop('Your Query Submitted Successfully.');
                $('#enquireform{{main_article.id}}')[0].reset();
                $('#enquire_form{{main_article.id}}').removeAttr("disabled");
                $('#popup_subscribe{{main_article.id}}').modal('toggle');
            },
            error: function(jqXHR, textStatus, errorThrown) {
                gaEventFunc(typeOfProduct,'failure');
                $('#enquire_form{{main_article.id}}').removeAttr("disabled");
                pop('Something went wrong. Try again later.');
            }
        });
    }
});
</script>
{% endfor %}

{% if page_obj.has_next %}
<div id="load_more" style='display:none'>
    <div>
      <input type="hidden" id="pg_id" name="page" value="{{page_obj.next_page_number}}">
      <input type="hidden" id="pg_slug" name="slug" value="{{slug}}">
      <input type="hidden" id="id_visibility" name="visibility" value="{{visibility}}">
    </div>
</div>
{% endif %}
{% block js_section %}
    {% compress js %}
    <script src="{% static 'shinelearn/js/talenteconomy/prism.js' %}"></script>
    {% endcompress %}
{% endblock js_section %}