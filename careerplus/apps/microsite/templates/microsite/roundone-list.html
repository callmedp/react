{% extends "basic/base.html" %}
{% load core_filter_tags %}
{% load static %}
{% load humanize %}
{% load thumbnail %}
    {% block meta_tags %}
        {{block.super}}
        {% include 'meta/meta.html' %}
    {%  endblock meta_tags %}

    {% block title %}
       Roundone - Shine Learning
    {% endblock title %}
    
    {% block css_section %}
        {{block.super}}
        <link type="text/css" href="{% static 'shinelearn/css/microsite/roundone.css' %}" rel="stylesheet">
        <link type="text/css" href="{% static 'shinelearn/css/common/multiple-select.css' %}" rel="stylesheet">
    {% endblock css_section %}

  {% block pageheading %}
  <header class="roundone-header">
    <div class="container">
    <!-- breadcrums -->
      <ol class="breadcrumb mt-30">
        {% for bread in breadcrumbs %}
            {% if bread.url %}
                <li><a href='{{bread.url}}'>{{bread.name}}
                </a></li>
            {% else %}
                <li class="active">{{bread.name}}</li>
            {% endif %}
        {% endfor %}
      </ol>
      <div class="roundone-caption">
        <h1>Request referrals</h1>
        <div class="">
          <form class="form-inline" id="roundone_search" method="POST">
          {% csrf_token %}
          <div class="form-group custom-select">
            <select class="form-control" id="id_search_location" 
              multiple="multiple" name="locationlist[]">
              {% for location in location_list %}
                  <option value="{{location}}">{{location}}</option>
              {% endfor %}
            </select>    
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="Job title, keyword or company name" name="keyword" value="{{initial_keyword}}">
          </div>
          <button type="button" class="find-jobs-btn btn" onclick="onClickRoundOneSearch();">Find jobs</button> 
          <span class="powered-by">Powered by</span>
          </form>
        </div>
      </div>
    </div>
  </header>
  {% endblock pageheading %}

{% block container %}

<!-- main section start -->
<section class="container">

    <!-- page content body start -->
    <div class="row">

    <!-- left content start -->
    <div id="filters" class="col-sm-3 col-md-2 mt-40">
      <div class="panel-group filters" id="accordion" role="tablist" aria-multiselectable="true">
        <h2>Refine search</h2>
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="headingOne">
            <h4 class="panel-title">
              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                Variation
              </a>
            </h4>
          </div>
          <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
            <div class="panel-body">
            {% for companyID, company in search_result.sortedCompany.items %}
              <label>
                <input type="checkbox" name="filterbyCompany" 
                value="{{companyID}}" {% if companyID in search_result.company_list %}checked{% endif %}>
                <span>{{company.companyName}} ({{company.jobCount}})</span>
              </label>
            {% endfor %}  
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="headingTwo">
            <h4 class="panel-title">
              <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Mode 
              </a>
            </h4>
          </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
            <div class="panel-body">
              <label>
                <input type="checkbox">
                <span>Online</span>
              </label>
              <label>
                <input type="checkbox">
                <span>Classroom</span>
              </label>
              <label>
                <input type="checkbox">
                <span>Blended</span>
              </label>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="headingThree">
            <h4 class="panel-title">
              <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                Price 
              </a>
            </h4>
          </div>
          <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
            <div class="panel-body">
              <label>
                <input type="checkbox">
                <span>0 - 5000</span>
              </label>
              <label>
                <input type="checkbox">
                <span>5000 - 10000</span>
              </label>
              <label>
                <input type="checkbox">
                <span>10000 - 20000</span>
              </label>
              <label>
                <input type="checkbox">
                <span>20000 - 30000</span>
              </label>
              <label>
                <input type="checkbox">
                <span>30000+</span>
              </label>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="headingFour">
            <h4 class="panel-title">
              <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                Duration 
              </a>
            </h4>
          </div>
          <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
            <div class="panel-body">
              <label>
                <input type="checkbox">
                <span>6 months</span>
              </label>
              <label>
                <input type="checkbox">
                <span>1 year</span>
              </label>
              <label>
                <input type="checkbox">
                <span>2 year</span>
              </label>
            </div>
          </div>
        </div>
      <button class="search-button" id="id_applyfilter" type="submit">
      Go</button>
      </div>
    </div>       
    <!-- left content end -->

    <!-- mid content start -->
    <div class="col-sm-9 col-md-7 mt-40 ">
      <div class="referral-heading-box">
      {% if search_result.jobCount %}
        <div class="form-group custom-select">
          <select id="id_search_sort" class="form-control">
            <option value="0">Most Relevant</option>
            <option value="1" {% if search_result.sort == 1 %} selected="selected"{% endif %}>Latest</option>
          </select>
        </div>
      {% endif %}
        <h2>
          {% if search_result.jobCount %}
              {% if clean_location == "all" %}
                  {% if clean_keyword == "all" %}
                      Showing top jobs
                  {% else %}
                      {{search_result.jobCount}} <strong>"{{clean_keyword|title}}"</strong> jobs
                  {% endif %}
              {% else %}
                  {% if clean_keyword == "all" %}
                      {{search_result.jobCount}} jobs in {{clean_location|title|truncatechars:20}}
                  {% else %}
                      {{search_result.jobCount}} <strong>"{{clean_keyword|title}}"</strong> jobs in {{clean_location|title|truncatechars:20}}
                  {% endif %}
              {% endif %}
          {% else %}
              No Jobs Found
          {% endif %}
        </h2>
      </div>

      <ul class="referral-jobs">
      {% for job in search_result.data %}
        {% with job.jobId|slugit:job.jobType|slugit:job.interviewerId as job_params %}
        {% url 'partner-detail' partner='roundone' job_title=job.jobTitle|slugify job_params=job_params as detail_url %}
        <li>
          <h2><a href="{{detail_url}}">{{job.jobTitle}}</a></h2>
          <span class="location"><strong>{{job.companyName}} </strong> | 
          {{job.jobLocation}}</span> 
          <!--
          <datatlist class="list1">Exp:</datatlist>
          <datatlist class="list2">4 years</datatlist>
          -->
          <div class="clearfix"></div>
          <datatlist class="list1">Job Description:</datatlist>
          <datatlist class="list2">
          {{job.jobDescription|safe|truncatewords:15}}</datatlist>
          <div class="clearfix"></div>
          <datatlist class="list1">Your Referrer:</datatlist>
          <datatlist class="list2">
          <figure>
            <img src="{% static 'shinelearn/images/referral-job.jpg' %}" 
            alt="Shine Learning">
          </figure>
            {{job.position}}, {{job.departmentName}}
          </datatlist>
          <a href="#" class="save-job">Save this job</a>
          <a href="{{detail_url}}" class="view-job">View job description</a>
          <a href="#" class="get-refferd pull-right">Get Referred</a>
        </li>
        {% endwith %}
      {% endfor %}
      </ul>
    </div>       
    <!-- mid content end -->

    <!-- right content start -->
    <div id="fix_form" class="col-sm-3 hidden-sm mt-40">
      <div class="how-it-works-rightbar">
      <h2>How it works</h2>
        <ul>
          <li>
            <figure class="request-referral-icon"></figure>
            <article>
              <strong>Request a Referral</strong>
              Search 10,000+ jobs and request referrals.
            </article>
          </li>
          <li>
            <figure class="speak-referrer-icon"></figure>
            <article>
              <strong>Speak with the Referrer</strong>
              We'll schedule a phone call.
            </article>
          </li>
          <li>
            <figure class="get-referred-icon"></figure>
            <article>
              <strong>Get Referred</strong>
              Prove your merit and earn a referral.
            </article>
          </li>
          <li>
            <figure class="interview-call-icon"></figure>
            <article>
              <strong>Get Hired!</strong>
              Increase your chance of getting hired by ten times!
            </article>
          </li>
        </ul>               
      </div>
      <div class="or-callus">
          Or call us at
          <strong>0124 - 3955001 / 02</strong>
      </div> 
    </div>       
    <!-- right content end -->

    </div>
    <!-- page content body end -->

</section>
<!-- main section end -->
{% endblock container %}
{% block js_section %}
   {{ block.super }}
   <script type="text/javascript">
    $(window).load(function(){
        {% if initial_location %}
            {% if "all" in initial_location %}
                $("#id_search_location").multipleSelect("checkAll");
                $("input[data-name=selectItemlocation]").prop('disabled', true);
            {% else %}
                $("#id_search_location").multipleSelect("setSelects", {{initial_location|safe}});
            {% endif %}
        {% else %}
            $("#id_search_location").multipleSelect("uncheckAll");
        {% endif %}
    });
   </script> 
    <script src="{% static 'console/js/microsite/multiple-select.js' %}">
    </script>
    <script src="{% static 'shinelearn/js/microsite/roundone.js' %}"></script>
{% endblock js_section %}