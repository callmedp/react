{% extends "mobile/basic/base.html" %}
{% load static custom_filters compress %}
{% load static compress %}

{% if search_type == "func_area" %}
    {% block django_meta %}
    {% include 'meta/meta.html' %}
    {%  endblock django_meta %}
    {% block canonical_url %}
      <link rel="canonical" href="https://{{ SITE_DOMAIN }}{{canonical_url}}">
      {% comment %} <link rel="alternate" href="//{{ SITE_DOMAIN }}{{canonical_url}}"> {% endcomment %}
    {% endblock canonical_url %}
{% endif %}

{% block title %}
{% if search_type == "func_area" %}
{{meta.title}}
{% else %}
Search Result Page - Shine Learning
{% endif %}
{% endblock title %}

{% block css_section %}
    {{ block.super }}
<style>
         .breadcrumb > li a{
        color:#ffffff;
        }

</style>
    {% compress css %}
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/homepage/home.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/common/checkbox.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/users/login.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/search/course-listing.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/common/auto-suggest.css' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/search/filter.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/zopim_chat/custom.css' %}" rel="stylesheet">
    <link type="text/css" href="{% static 'shinelearn/css/common/mobile/typeaheadjs.css' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/common/slick.scss' %}" rel="stylesheet">
    <link type="text/scss" href="{% static 'shinelearn/css/mobile/search/amcat-widget.scss' %}" rel="stylesheet">
    {% endcompress %}
{% endblock css_section %}

{% block header %}
    <header class="w100fl he-auto">
        <img loading="lazy" aria-label="header search" src="{% static 'shinelearn/images/mobile/search/header-search.png' %}">
        <!-- header menu Icon Starts here -->
        <div class="main-menu w100fl">
            <div class="pull-left">
                <a class="pull-left" id="sidebar-main-trigger" role="button"></a>
                <a class="icon-back pull-left" href="/"></a>
            </div><!-- / Left side Icon ends here -->

            <div class="pull-right">
                <!--a class="icon-search pull-left" href="search-listing.html">search</a-->
                <a class="icon-cart" href="{% url "cart:payment-summary" %}" >cart <span id="cart-counter-id">{{cart_count}}</span></a>
            </div><!-- / Right side Icon ends here -->
        </div><!-- header menu Icon ends here -->
 {% block breadcrumbs %}
                  {% include "shop/partials/breadcrumb.html" %}
                {% endblock breadcrumbs %}


        <div class="clearfix"></div>
        {% if search_type == 'recommended' %}
        <div class="search-tagging mt-10">
            <span class="advanced">{{ recmnd_func_area }}</span>
            <span class="advanced">{{ recmnd_skills }}</span>
            <a href="javascript:void(0)" class="icon-edit sidebar-secondary-trigger js_advanced_trigger" ></a>
        </div>
        {% else %}
        <div class="custom-search mt-15">
            <input class="form-control key_press_js_search" id="id_q" placeholder="Search for courses, services"
                   type="text" autocomplete="off" value="{{ search_params.keywords }}">
            <span class="error-txt"></span>
            <button type="images" onclick="redirectToSearch()" class="search-icon-tab"></button>
        </div>        
        
        
        
        <!-- <div class="search-tagging mt-10">
            <form class="search-list" id="search_form" data-role="form">
            <input type="text" id="id_q" placeholder="Search for courses, services" name="q" class="form-control js_query_input key_press_js_search" value="{{ search_params.keywords }}" id="search-inupt">
            </form>
        </div> -->
        {% endif %}
    </header><!-- header ends here -->
{% endblock header %}

{% block container %}
    <div class="body-wrapper ">
<div class="content-box pt-0">
  <div class="container pt-0 js_listing">

    <!-- amcat certification start -->
                                {% if facets.pFA|length >= 1 %}
              {% if vendor_banner %}
    <div class="amcat-certification">
        <div class="amcat-box">
            <img loading="lazy" class="img-responsive" alt="" src="{{vendor_banner}}">
        </div>
        <div class="amcat-tags mt-30">
            <div class="slide-container">
                <ul class="skill-provider amcat-tags">
       {% for facet in facets.pFA %}
                           <li class="cuad">
                         {% if forloop.counter0 == 0 %}
    <a name="filterBtn" id="facet-{{forloop.counter0}}" data-data="0" onclick="filterSearch(event)" class= "check{{forloop.counter0}}{% if not areaf %} selected{% endif %}">All</a>
            {% endif %}
                    </li>
                    <li class="cuad">
            <a  name="filterBtn" data-data="{{facet.id}}" onclick="filterSearch(event)" class=
                    {% if facet.label == 'Others' %}
            {% if facet.id in areaf %}"check{{forloop.counter}} selected"{% endif %}

            {% else %}
            {% if facet.id|stringformat:"i" in areaf %}
            "check{{forloop.counter}} selected"
            {% else %}
                    "check{{forloop.counter}}"
            {% endif %}
            {% endif %}>{{facet.label}}
                </a>
                        </li>
                {% endfor %}

               </ul>
            </div>
        </div>

    </div>
              {% endif %}
      {% endif %}
    <!-- amcat certification end -->

    <div class="row enrol-now box pt-5 pb-5" id="hide-second">

        <h2 class="pt-5 filter-pd">
        {% if products_found %}
            {% if search_type == 'recommended' %}{{ paginator.count }} recommended products
                {% elif search_type == 'simple' %}{{ paginator.count }} products found
            {% elif search_type == 'func_area' %}{{ func_area_name|title }}{% endif %}
        {% else %}
            No products found. Have a look at our most popular products.
        {% endif %}
            {% if products_found and page.object_list|length > 0 %}<a href="javascript:void(0)" class="icon-filter-white pull-right sidebar-secondary-trigger js_filters_trigger"></a>{% endif %}
        </h2>
    </div>
    
    {% include 'mobile/search/ajax/search_listing.html' %}

    
  </div><!-- end of container -->
    <span id="loading"></span>
</div><!-- end of content box -->


{#<div class="sidebar js_sidebar_advanced">#}
{#  <div class="right-navbar pt-0">#}
{#    <h2>Advanced Search</h2>#}
{#    <form method="post" action="{% url 'search:recommend' %}" class="js_advance_search_form">#}
{#        {% csrf_token %}#}
{#      <div class="form-group">#}
{#        <input type="text" id="tags11" class="form-control" name="area" value="{{ recmnd_func_area }}" placeholder="Functional area">#}
{#        <p class="mgs js_area_error"></p>#}
{#      </div>#}
{##}
{#      <div class="form-group">#}
{#        <input type="text" id="tags21" name="skills" value="{{ recmnd_skills }}" class="form-control" placeholder="Skill">#}
{#        <p class="mgs js_skill_error"></p>#}
{#      </div>#}
{#      <div class="form-group text-center mt-40">#}
{#        <button type="submit" class="btn btn-blue w100fl btn-round mb-20 js_advance_search">Find courses</button>#}
{#      </div>#}
{##}
{#    </form>#}
{#  </div>#}
{#</div>#}

{% if products_found and page.object_list|length > 0 %}
    {% include "mobile/search/partials/search_filters.html" %}
{% endif %}


</div>

<div class="stick_bottom call-us">
    <div class="ui-grid-a block-3 text-center">
        <div class="ui-block-a">
            <a href="javascript:void(0)" id="enquire_btn"><span></span>Enquire</a>
        </div>
        <div class="ui-block-b">
            <a href="tel:{{ggn_contact}}"><span></span>Call Us</a>
        </div>
        {% if not request.amp %}
        <div class="ui-block-c"><a href="JavaScript:void(0);"> <span></span>Chat </a></div>
        {% endif %}
    </div><!-- call us and chat widget ends here -->
</div>


<div class="enquire" id="enquire">
    <header>
        <a class="icon-back pull-left" id="back_btn"></a>
    </header>
    <div id="snackbar"></div>
    <div class="enquire__wrap">
        <h2 class="enquire__wrap--head">Enquire now</h2>
        <p class="enquire__wrap--subhead">Share your query, our experts will help you take your career forward!</p>
        <div class="content-box login-form">
            <form id="enquireform" name="enq">
                <div class="form-group">
                    <input type="text" name="name" placeholder="Name" class="form-control" maxlength="60" inputmode="name" value="{{request.session.full_name}}" id="id_name" aria-required="true">
                </div>
                <div class="form-group enquire__flex">

                    <div class="code">
                        <select name="country_code" class="form-control" id="id_country_code">
                          {% for country in country_choices %}
                            <option value="{{country.0}}" {% if country.0 == initial_country %} selected {% endif %} >{{country.0}}</option>
                          {% endfor %}
                        </select>
                    </div>
                    <span class="mobile_input">
                        <input type="tel" name="number" class="form-control number" inputmode="numeric" required="" id="id_cell_phone" aria-required="true" placeholder="Mobile" value="{{request.session.mobile_no|safe}}">
                    </span>

                </div>


                <div class="form-group mb-30">
                    <textarea class="form-control" rows="2" name="msg" placeholder="Message"></textarea>
                </div>
            <input type="hidden" name="product" value="FuncArea">
            <input type="hidden" name="prd" value="{{func_area_name}}">
            <input type="hidden" name="path" value="{{request.build_absolute_uri}}">
            <input type="hidden" name="email" class="form-control" value="{{request.session.email}}">
            <div class="form-group">
                <button type="submit" id="enquire_form" class="btn btn-blue w100 btn-round">Submit</button>
            </div>

            </form>
        </div>
    </div>
</div>


{% endblock container %}

{% block js_section %}
    {{block.super}}
    <script>
        var funcAreaSet = {{ func_area_set|safe|default:"[]" }},
            skillsSet = {{ skills_set|safe|default:"[]" }},
            totalProducts = {{ paginator.count }};
    </script>
    {% compress js %}
    <script src="{% static 'shinelearn/js/mobile/search/search.js' %}"></script>
    <script src="{% static 'shinelearn/js/mobile/homepage/index.js' %}" type="text/javascript"></script>
    <script src="{% static 'shinelearn/js/mobile/zopim_chat/custom.js' %}"></script>
    {% endcompress %}


<script type="text/javascript">

function gaEvent(event_cat,event_lab,event_action){
  ga('send', 'event', event_cat, event_action, event_lab);
 }

 function gaEventFunc(status){
    var event_cat='Form Interactions';
    gaEvent(event_cat,status,"Functional Area");
 }


$.validator.addMethod("numbercheck", function (value, element) {
    if( $('#id_country_code').val() == "91" && $('#id_cell_phone').val().length != 10){
     $('#enquire_form').removeAttr("disabled");

        return false;
    }
    else if($('#id_cell_phone').val().length >= 8 && $('#id_cell_phone').val().length <= 15){
        return true
    }
}, 'please enter valid mobile number');



$(function() {
  // Initialize form validation on the registration form.
  // It has the name attribute "registration"
  $("form[name='enq']").validate({
    // Specify validation rules
    rules: {

    number:{
        numbercheck : true,
    },
      msg: {
        maxlength:250,
      }
    },
    // Specify validation error messages
    messages: {
      msg: {
        maxlength: "Message should be within 250 characters",
      },

    },
    // Make sure the form is submitted to the destination defined
    // in the "action" attribute of the form when valid

  });
});



$('#enquire_form').click(function(event) {
    event.preventDefault();
        $('#enquire_form').attr("disabled", true);
    var $enquireform = $("#enquireform");
    var flag = $enquireform.valid();
    if (flag) {
        var formData = $enquireform.serialize();
        $.ajax({
            url: "/lead/lead-management/",
            type: "POST",
            data: formData,
            success: function(data, textStatus, jqXHR) {
                gaEventFunc('success');
            pop('Your Query Submitted Successfully.');
               $('#enquire_form').removeAttr("disabled");

                $('#enquireform')[0].reset();

            },
            error: function(jqXHR, textStatus, errorThrown) {
                gaEventFunc('failure');
                  $('#enquire_form').removeAttr("disabled");


                pop('Something went wrong. Try again later.');
            }
        });
    }
});


function pop(param) {
    // Get the snackbar DIV
    var x = document.getElementById("snackbar");
    x.innerHTML=param;

    // Add the "show" class to DIV
    x.className = "show";

    // After 3 seconds, remove the show class from DIV
    setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3500);
}





</script>

{% endblock js_section %}

