{% extends "console/base_console.html" %}
{% load static %}
{% load humanize %}

{% block title %} 
    <title> Order Management </title>
  {% endblock title %}

{% block css_block %}
    {{block.super}}
    <link type="text/css" href="{% static 'console/css/myadmin/django-admin-widgets.css' %}" rel="stylesheet">
{% endblock css_block %}

{% block pagecontent %}

<!-- page content -->
<div class="right_col" role="main">
  {% include partial_template %}
</div>
<!-- /page content -->

{% endblock pagecontent %}


{% block js_block %}
    {{block.super}}
    <script src="{% static 'console/js/myadmin/django-admin.multiselect.js' %}"></script>
    <script type="text/javascript">
      window.onload = function(){
        $.each($("select[multiple]"), function () {
          // "Locations" can be any label you want
          if (this.id && this.name) SelectFilter.init(this.id, this.name, 0, "/media/");
        });
        $('ul.nav.child_menu>li>a[data-pjax], tbody>tr>td>a[data-pjax], .right_col form>div>a[data-pjax], .right_col form button[data-pjax]').pjax();
        var selected = $('tbody>tr');
        var orderitemIds = selected.map(function(ind,val){return val.attributes['data-attr-id'].value;}).toArray();
        $.ajaxSetup({
          beforeSend: function(xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
            }
          }
        });
        $.ajax({
          url: '/console/operations/vendor/' + String(selected.attr('data-attr-vendorid')) + '/neworders/upload/',
          type: 'GET',
          success: function(data){
            for (key in data) {
              $('tbody>tr>td>form>span[data-attr-id='+key+']').html('<a href="/media/' + data[key] + '">'+ data[key]+ '</a>');
              $('tbody>tr>td[data-attr-id='+key+']').html('<a href="/media/' + data[key] + '">'+ data[key]+ '</a>');
            }
          }
        });
      };
    </script>
    <script type="text/javascript" src="{% static 'myadmin/js/blog/comment-action.js' %}"></script>
{% endblock js_block %}