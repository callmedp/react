{% extends "basic/base.html" %}
{% load static compress %}
{% block title %}
    Register
{% endblock title %}
{% block css_section %}
    {{block.super}}
    {% compress css %}
    <style type="text/css">
      .error {
            color: red;
      }
    </style>
    {% endcompress %}
{% endblock css_section %}
{% block container %}

    <div class="row">
        <div class="col-lg-12">
            {% if messages %}
                {% for message in messages %}
                <div{% if message.tags %} class="alert alert-{{ message.tags }} alert-dismissable"{% endif %}>{{ message }}</div>
                {% endfor %}
            {% endif %}
        </div>
        <!-- /.col-lg-12 -->
    </div>
        <!-- /.row -->
    <!-- main section start -->
    <div class="container pr">
        <header class="login-page-bg">
            <div class="login-bg-txt">
                <figure class="login-icon1"></figure>
                <strong>1 Lacs+</strong>
                Satisfied users
            </div>
            <div class="login-bg-txt">
                <figure class="login-icon2"></figure>
                <strong>300+</strong>
                Courses
            </div>
            <div class="login-bg-txt">
                <figure class="login-icon3"></figure>
                <strong>500+</strong>
                Professional resumes delivered
            </div>
        </header>

        <!-- login form start -->
        <div class="register login-signup-box">
            <div>
                <h1 class="modal-title">Register</h1>
            </div>
            <form method="post" id="register_form" role="form">
                {% csrf_token %}
                <div class="form-group {% if form.email.errors %}error{% endif %}">
                    {{ form.email }}
                    <span class="error-txt" style="bottom:-25px">{{ form.email.errors }}</span>
                </div>
                <div id="user_email"></div>
                <div class="form-group {% if form.email.errors %}error{% endif %}">
                    {{ form.raw_password }}
                    <span class="error-txt" style="bottom:-25px">{{ form.raw_password.errors }}
                    </span>
                </div>
                <div id="raw_psd"></div>
                <div class="form-group {% if form.cell_phone.errors %}error{% endif %}">
                    <div class="country-code">
                        <div class="custom-select">
                            {{form.country_code}}
                        </div>
                        {{form.cell_phone}}
                        <span class="error-txt" style="bottom:-33px">{{form.cell_phone.errors}}
                        </span>
                    </div>
                </div>
                <div id="cell_phone"></div>
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input"
                            name="term_conditions">
                            I agree to <a href="/tnc">Terms & conditions</a>
                    </label>
                </div>
                <div id="terms"></div>
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input"
                        name="is_job_seeker">
                        Recieve jobs notifications
                    </label>
                </div>
                <button type="submit" class="btn btn-primary submit">Register</button>
                <div class="social-login">
                    <span>or Register with</span>
                    <a class="facebook" onclick="Login();"></a>
                    <a class="linkedin" href="{% url 'users:linkedin-code' %}"></a>
                    <a class="gplus" onclick="glogin()"></a>
                </div>
                <small class="form-text text-muted text-center mt-4">
                    Already have an account? <a href="{% url 'login' %}">Login Now</a>
                </small>
            </form>
        </div>
        <!-- login form end -->

    </div>
    <!-- main section end -->
<script>
    // Social Facebook Login 
    window.fbAsyncInit = function() {
        FB.init({
          appId  : '473197949429502', // App ID
          status : true, // check login status
          cookie : true, // enable cookies to allow the server to access the session
          xfbml  : true , // parse XFBML
          version: 'v2.10',
        });
    };
    
    function Login()
    {
        FB.login(function(response) {
           if (response.status == 'connected')
               {
                    var accessToken = response.authResponse.accessToken;
                    var expiresIn = response.authResponse.expiresIn;
                    window.location.href = '/user/social/login/?accessToken='+accessToken+'&expiresIn='+expiresIn+'&key=fb';
                    console.log(response);
               } 
            else 
                {
                 console.log('User cancelled login or did not fully authorize.');
                }
        },{scope: 'email'});
     }
    // Load the SDK asynchronously
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.10&appId=473197949429502";
            fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
    
    // Social Gplus Login

    function loginCallback(result)
    {

        if(result['status']['signed_in'])
            {
                console.log(result);
                var access_token = result.access_token
                var expiresIn = result.expires_in
                window.location.href = '/user/social/login/?accessToken='+access_token+'&expiresIn='+expiresIn+'&key=gplus';
            }   
    }


    function glogin() 
    {
        var myParams = {
            'clientid' : '284765467291-lo164ec1u4pcnhtrbicird7tsdt553sm.apps.googleusercontent.com',
            'cookiepolicy' : 'single_host_origin',
            'callback' : 'loginCallback', //callback function
            'approvalprompt':'force',
            'scope' : 'profile email',
        };
        gapi.auth.signIn(myParams);
    }

    var auth2;
    var startApp = function() {
        gapi.load('auth2', function(){
            /* Retrieve the singleton for the GoogleAuth library and set up the client.*/
            auth2 = gapi.auth2.init({
                client_id: '284765467291-lo164ec1u4pcnhtrbicird7tsdt553sm.apps.googleusercontent.com',
                cookiepolicy: 'single_host_origin',
                /* Request scopes in addition to 'profile' and 'email'*/
                scope: 'profile email'
            });
        });
    };

    (function() {
       var po = document.createElement('script'); po.type = 'text/javascript'; 
       po.async = true;
       po.src = 'https://apis.google.com/js/client.js?onload=startApp';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
     })();
</script> 
{% endblock container %}
{% block js_section %}
    {{block.super}}
    {% compress js %}
    <script src="{% static 'shinelearn/js/users/registration.js' %}"></script>
    {% endcompress %}
{% endblock js_section %}
{% block johukum %}
{% endblock johukum %}
